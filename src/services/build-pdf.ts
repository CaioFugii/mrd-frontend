/* eslint-disable @typescript-eslint/no-explicit-any */
import jsPDF from "jspdf";
import autoTable from "jspdf-autotable";
import { formatToBRL } from "../utils/formatToBRL";

interface Addon {
  addonNameSnapshot: string;
  addonPriceSnapshot: number;
  quantity: number;
  totalPrice: number;
}

interface Item {
  productNameSnapshot: string;
  productPriceSnapshot: number;
  totalPrice: number;
  addons: Addon[];
}

interface Budget {
  id: string;
  sequentialNumber: number;
  customerName: string;
  customerEmail: string;
  customerPhone: string;
  discountPercent: number;
  total: number;
  issueInvoice: boolean;
  approved: boolean;
  createdAt: string;
  seller: { name: string };
  items: Item[];
}

export const logoBase64 =
  "data:image/png;base64,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xCe46aab2GabbZgzZw7nnHMORx55JLNnzw7nvRKgOt4VOkNMJOb2C1T/ehStyN+KzU64/hQhD8yjtOCA/fflmo+8j7Pf/jrmbD+MTgqELBHSIpUPXRyqXvDhbz06EXgfRM75EYRaTdocZdbWmgMO3pWTTz2S91z4Nj75qY+x5ezpYTYf6+l2uix78EHuvfe3LFjwe9auXRtGOkUYybzlllu44YZP8clP3sh733sRjzzyKNZ4hNBYC2nSQMmUNM3Qum4PExJXazGYOMYgFL/+9a+55557cM7x93//9xx99NG86U1vYv369TjnuO2223jooYfI85DzFqw9Q1EUTJkyhW233XYD17u2wGbPns2rX/1q9thjD5K6J1glOLV1FolsajZz4apjWKFXVAjgS3AJSjZotjJeddRLuPEzH+Etbz2JLbYcBhm6cIbWOPU+HN4bPF0GhzVbbzONVxx2EG/7u2O5/Mqz+NwXruYT11/CaWe8ihe9ZF9mzhpEJ5Yi7/K9O+/kjNPfwpFHHMErD38FrzzsUI4/7gRu/eotdPNxEJ5ms4GUisHBYb7z7ds599wLePjhR7DWo1XC4OAUnINWq1UJxURszjnXyygXlZtsjeWrt95KWZYMDQ3R6XQ48sgjufbaa/niF7/IvHnzWLp0KV/96lfJ85zZs2ez//77k2YZg0ND3Hzzzdx2222k6UTzwlqcauurFrVaNPvfQySyqRF+s/4J3fCt+745/KqMgJ7F4B08sOQRPvHRz/Kz//wV1oYY2dDgAFtvO405209jv+fvy9ztd2S77bdlcCjMhlPkOePt9Wid0WoNIqTDO0Onk/OBf7iMb33rX9lll13Zf//9mDptmLv/525+8uOf4oXnQ1dezvHHHc9VV13D9ddfz7nnnsfPf/5zfvGLX7DHHrvzsY99jF2fNY8vf+UrvOc97+V973sP5513bi994je/+R9OOOEEdtxxR2655RaGh4cBePTRR3nBwQczc+ZMvnLLLWyzzTbBnRQSj+fmL93Mnd+7k5e//OW8+uij6eY5W8yYgVSh9rHund87N31xqPp+PYJb0291PVPESzxTDnRzxD+dcdXinfe+9GVZ+m//y/f8y15yvN9vryP9Afse47/7nf/069aM+aIofGm6Ps+7vtst/K9/dbe//PLL/THHHONf/OIX+0MPPdRffPHFfs2aNX58fNyfffbZfs6cOf6KK67wq1ev9nme+zzP/fr16/3VV1/tt9pqK/+qV73Kr1mzxl999dV+1qxZ/tZbb/XLli3zZ5xxhp81a5Z//vOf73/0ox/5f/qnf/KzZs3yH/nIR7y11ltrvTHG/+xnP/Nz5871Bx10kF+1apUvisIbY/yNN97oZ82a5S+//HJflqW31m5w2N1u13c6HZ/nuS+KwjvnNtgeeXxsfK1EJg+buav4eAmul/eGlxxyEB/+yKW87g1Hcull7+Ggg/diYLCBlB5nDePjY9xwwyc5+ZRT+PKXv0xRFMyYMYOHHnqI73//+1hr+da3vsW3vvUtjj/+eC644IIwP2HlXjUaDV772tey5ZZbsnz5csbGxnrul7WWWbNmcc0113DKKaewdOlSzjvvPP71X/81vMvqWqlvi6LoJYL2W0crVqzgne98J6ecckqvVKefJEl6pTtE9y7ydGTjX5mnFT2Ly3rvC29MxxdFx5vS+LKwYSlLb2zYNjK6xl9xxeV+++139G898xz/m9/8xq9fv96PjY35e+65x//iF7/w7XbbH3LIIX7OnDn+4Ycf9kVR+G63G/ZjjC/L0i9evNjvvffe/qCDDvKPPPKI/9CHPuRnzpzpv/SlL/WsppGREX/11Vf7OXPm+FmzZvlZs2b5q6++2htjehbXj370I3/UUUf5Sy65xK9bt84XReGLovDj4+O916v314+1tvf4Y1lkkcfHxtdKZPLwDLG4BFSdS7WWSOVR2qO0QymQInRl/c///E8+97nPcfDBB/OhK6/guc/dk6GhIVqtFrvvvjt77bUXjz76KIsWLWKLLbZg5syZYe+VRVPnTS1atIhVq1bx3Oc+l+HhYbrdLkIIjDForSnLkmazydvf/nYuueQSBgYGSNOUVqvV25dSigMOOIAvfvGLfOADH2BoaKhXR9hoNDYolanTEXpHWz0upew9LxJ5OvEMES4AiRCqWqo6SBH6gQmhKEvLzV/6CsY4zjjjdKZMGeo1DawvfFG1bxFC0G63ezlStQvnvWfdunV84hOfoNFocPLJJyOq3lNUrqK1tleTp7XmlMolvf322znxxBN7o3cAWZYxZcoUZJV0Wr+X+n59uzH18/qXSOTpxNNbuIKh1XdHhtyt/rIfL8BLRkbG+PWv72Hq1KnssMPc0KWhf1eVxTRt2jSmTp3K6OgoH/3oRynLEl91EF2wYAEXXHABd999N+effz777LNPSBg1hu22246ZM2duIIL1/ec973nstttuDA8PI6oRvUgk8sfZzNMh/hwhrSAI1MbbNmTFihUc/IIXMTDQ5Otfv42dd94RUU1gQTX92Pz589l999255ZZbuOiii1BKsdtuu7HbbruxYsUKfv3rXyOl5IILLuCkk07qJXDWfdfrFi41vsqTqoWvduuilTQ5iOkQkxfhvfftdvsPWus+PajV6s8L15q1azjssMNYvnw5H/zgBzn11FOhGilcuXIlV111Fbfffjvf/OY32X777bn99tv5x3/8R+655x6klMyZM4cXv/jFvP71r2fevHk99+6J8vT5DDZfonBNXp7mwvX4McZw6aWX8pnPfIbp06fzute9jnnz5nHvvfdyxx138PDDD/Pud7+bN7/5zb2JK+oGetZaWq0wm3N/PCqyeROFa/IShavCOce6deu48MILuf322ynLElH1l99nn314xzvewT777IPWuhdgr+NRoi843x9Efyaex6cTUbgmL1G4KnzVLaEOsj/wwANordljjz2YNWsWSZL0tvenGfQLF9W5i6L19CAK1+QlClck8keIwjV5eeLR40gkEtlEROGKRCKbHZLHKO6NRCKRyYykylUiClckEtlMkFQ1ccSgfCQS2UyQ9AlWFK5IJLI50Itx+WdQS97IM5MYCnn60Itx1XGuKF6RpytRuJ4+xHSIyDOGx2pzHdk8icIVecawatWqjR+KbKZE4Yo8YyjLcuOHIpspUbgizxhijOvpQxSuyDOGOPD09OFp3ro5EnnixO4Qk5docUUikc2OKFyRSGSzIwpXJBLZ7IjCFYlENjuicEUikc2OKFyRSGSzIwpXJBLZ7IjCFYlENjuicEUikc2OKFyRSGSzIwpXJBLZ7IjCFYlENjuicEUikc2OKFyRSGSz4/8D8BmFc0TcT6AAAAAASUVORK5CYII=";

export const handleExportPDF = (budget: Budget) => {
  if (!budget) return;

  const doc = new jsPDF();
  const lineHeight = 7;
  let y = 10;

  // Cabeçalho institucional
  doc.setFontSize(10);
  doc.addImage(logoBase64, "PNG", 150, y - 25, 90, 50); // (img, type, x, y, width, height)
  doc.text("MRD CONTAINERS LTDA.", 10, y);
  y += lineHeight;
  doc.text("AV: TAKATA N°108 MARGINAL BR 101 OESTE - PIÇARRAS", 10, y);
  y += lineHeight;
  doc.text(
    "Fone: (47) 3345-3443 / (47) 3345-2916 | E-mail: vendas@mrdcontainers.com.br",
    10,
    y
  );
  y += lineHeight;

  // Nome do vendedor
  const sellerName = budget.seller?.name || "----";
  doc.text(`Vendedor: ${sellerName}`, 10, y);
  y += lineHeight + 2;

  // Título
  doc.setFontSize(14);
  doc.setFont("Verdana", "bold");
  doc.text("ORÇAMENTO DETALHADO", 105, y, { align: "center" });
  y += lineHeight + 2;

  // Dados do orçamento
  doc.setFontSize(11);
  doc.setFont("Verdana", "normal");
  doc.text(`ORÇAMENTO Nº: ${budget.sequentialNumber || "----"}`, 10, y);
  doc.text(`DATA: ${new Date(budget.createdAt).toLocaleDateString()}`, 150, y);
  y += lineHeight;
  doc.text(`CLIENTE: ${budget.customerName}`, 10, y);
  doc.text(`FONE: ${budget.customerPhone}`, 150, y);
  y += lineHeight;
  if (budget.customerEmail) {
    doc.text(`EMAIL: ${budget.customerEmail}`, 10, y);
    y += lineHeight;
  }

  y += 2;

  // Tabela dos produtos e adicionais
  const rows: string[][] = [];

  budget.items.forEach((item: Item, index: number) => {
    rows.push([
      `${index + 1}) ${item.productNameSnapshot}`,
      formatToBRL(item.productPriceSnapshot),
      formatToBRL(item.totalPrice),
    ]);

    item.addons?.forEach((addon) => {
      rows.push([`   ${addon.quantity}x ${addon.addonNameSnapshot}`]);
    });
  });

  autoTable(doc, {
    head: [["Produto / Adicional", "Unitário", "Total"]],
    body: rows,
    startY: y,
    styles: {
      fontSize: 10,
      lineColor: [200, 200, 200],
      lineWidth: 0.1,
    },
    headStyles: {
      fillColor: [40, 47, 82],
      textColor: 255,
      halign: "left",
    },
    alternateRowStyles: { fillColor: [245, 245, 245] },
    margin: { horizontal: 10 },
  });

  const tableEndY = (doc as any).lastAutoTable.finalY;

  // Se estiver muito próximo do fim da página, criar nova folha
  if (tableEndY > 260) {
    doc.addPage();
    y = 10; // Reinicia o cursor vertical
  } else {
    y = tableEndY + 10;
  }

  // Total e desconto
  const finalY = (doc as any).lastAutoTable.finalY + 10;
  doc.setFont("Verdana", "bold");
  doc.text(`TOTAL: ${formatToBRL(budget.total)}`, 150, finalY);

  let yInstructions = finalY + 5;
  doc.setFontSize(11);
  doc.setFont("bold");
  doc.text("FRETE:", 10, yInstructions);
  yInstructions += lineHeight;
  doc.setFont("Verdana", "normal");
  doc.text(
    "   Por conta do cliente, retirado em nosso terminal.",
    10,
    yInstructions
  );

  yInstructions += lineHeight + 2;
  doc.setFont("Verdana", "bold");
  doc.text("EXCLUSÕES DE FORNECIMENTO:", 10, yInstructions);
  yInstructions += lineHeight;

  doc.setFont("Verdana", "normal");
  doc.text(
    "   Instalação civil no local da entrega. Ex: sapatas ou alinhamentos.",
    10,
    yInstructions
  );
  yInstructions += lineHeight;
  doc.text(
    "   Instalações elétricas e hidráulicas no local.",
    10,
    yInstructions
  );
  yInstructions += lineHeight;
  doc.text("   ART’s e taxas junto a Órgãos Públicos", 10, yInstructions);
  yInstructions += lineHeight;
  doc.text("   Transporte carga e descarga com munck.", 10, yInstructions);
  yInstructions += lineHeight;

  yInstructions += 2;
  doc.setFont("Verdana", "italic");
  doc.text(
    "Obs.: Intermediamos o transporte com duas empresas parceiras.",
    10,
    yInstructions
  );
  yInstructions += lineHeight;

  doc.setFont("Verdana", "bold");
  doc.text(
    "Ficamos à disposição para sanar quaisquer dúvidas.",
    10,
    yInstructions
  );

  // Salvar
  const safeName = budget.customerName.replace(/\s+/g, "_");
  doc.save(`orcamento_${safeName}.pdf`);
};
